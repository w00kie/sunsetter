{"version":3,"sources":["webpack://sunsetter/./static/src/app.ts","webpack://sunsetter/./static/src/tools.ts","webpack://sunsetter/./node_modules/spin.js/spin.js","webpack://sunsetter/webpack/bootstrap","webpack://sunsetter/webpack/runtime/define property getters","webpack://sunsetter/webpack/runtime/hasOwnProperty shorthand","webpack://sunsetter/webpack/runtime/make namespace object"],"names":["tokyo","getAzimuth","pov","poi","povLat","lat","toRad","poiLat","dLon","lng","y","Math","sin","cos","x","atan2","toBrng","setHash","povpos","getPosition","toUrlValue","poipos","window","location","hash","map","navigator","geolocation","getCurrentPosition","position","latlng","google","maps","LatLng","coords","latitude","longitude","panTo","parser","URLSearchParams","substring","get","str","coord","split","spinner","Spinner","lines","length","width","radius","rotate","color","speed","shadow","className","zIndex","top","left","spin","document","getElementById","_gaq","push","povlat","round","results","fetch","method","headers","body","JSON","stringify","az","then","response","json","data","matches","daylist","createElement","classList","add","day","dayli","innerText","append","suntype","appendChild","stop","catch","error","Number","prototype","this","PI","toDeg","decimals","pow","__assign","Object","assign","t","s","i","n","arguments","p","hasOwnProperty","call","apply","defaults","scale","corners","fadeColor","animation","direction","opts","target","el","setAttribute","css","transform","insertBefore","firstChild","borderRadius","shadows","boxShadow","regex","_i","_a","match","xUnits","yUnits","prefix","end","parseBoxShadow","degrees","backgroundLine","height","background","getColor","transformOrigin","delay","line","normalizeShadow","drawLines","requestAnimationFrame","cancelAnimationFrame","animateId","clearTimeout","parentNode","removeChild","undefined","props","prop","style","idx","normalized","shadows_1","xy","convertOffset","join","radians","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","d","definition","key","o","defineProperty","enumerable","obj","r","Symbol","toStringTag","value","onload","Map","center","zoom","mapTypeId","MapTypeId","ROADMAP","markerpos","povmarker","Marker","icon","povicon","draggable","visible","poimarker","los","Polyline","path","strokeColor","strokeOpacity","strokeWeight","setMap","resultsDOM","azimuthDOM","event","addListener","getVisible","setPosition","latLng","setVisible","display","tools","queryMatch","remove","marker","addDomListener","setPath","innerHTML","addEventListener","getHash","strToLatLng","bounds","LatLngBounds","extend","fitBounds","askGeolocation"],"mappings":"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","file":"bundle.js","sourcesContent":["import * as tools from './tools'\n\n// povicon url from index.html\ndeclare const povicon: string\n\nconst tokyo = new google.maps.LatLng(35.41, 139.44)\n\nwindow.onload = () => {\n    // Create map\n\n    const map = new google.maps.Map(document.getElementById(\"map_canvas\") as HTMLElement, {\n        center: tokyo,\n        zoom: 9,\n        mapTypeId: google.maps.MapTypeId.ROADMAP\n    })\n\n    // Default marker position\n    const markerpos = new google.maps.LatLng(1, 1)\n\n    // Initialize POV and POI Markers as well as LOS Polyline\n    const povmarker = new google.maps.Marker({\n        position: markerpos,\n        map: map,\n        icon: povicon,\n        draggable: true,\n        visible: false\n    })\n\n    const poimarker = new google.maps.Marker({\n        position: markerpos,\n        map: map,\n        draggable: true,\n        visible: false\n    })\n\n    const los = new google.maps.Polyline({\n        path: [\n            povmarker.getPosition(),\n            poimarker.getPosition()\n        ],\n        strokeColor: \"#FF0000\",\n        strokeOpacity: 0.6,\n        strokeWeight: 6,\n        visible: false\n    })\n\n    los.setMap(map)\n\n    const resultsDOM = document.getElementById('results')\n    const azimuthDOM = document.getElementById('azimuth')\n\n    // Click on the map event - works only 2 first times\n    google.maps.event.addListener(map, 'click', (event) => {\n        // First click, show POV marker\n        if (!povmarker.getVisible()) {\n            povmarker.setPosition(event.latLng)\n            povmarker.setVisible(true)\n            document.getElementById(\"step1\").classList.remove(\"active\")\n            document.getElementById(\"step2\").classList.add(\"active\")\n            // Second click, show POI marker\n        } else if (!poimarker.getVisible()) {\n            poimarker.setPosition(event.latLng)\n            poimarker.setVisible(true)\n            los.setVisible(true)\n            document.getElementById(\"azimuth\").style.display = 'block'\n            tools.queryMatch(povmarker, poimarker)\n            document.getElementById(\"step2\").classList.remove(\"active\")\n            document.getElementById(\"step3\").classList.add(\"active\")\n        }\n    })\n\n    // Move markers event\n    for (const marker of [povmarker, poimarker]) {\n        google.maps.event.addDomListener(marker, 'position_changed', () => {\n            los.setPath([povmarker.getPosition(), poimarker.getPosition()])\n            let az = tools.getAzimuth(povmarker.getPosition(), poimarker.getPosition())\n            azimuthDOM.innerText = `${az.round(2)}º`\n            // Clear results\n            resultsDOM.innerHTML = ''\n        })\n    }\n\n    // Query for a match on drop\n    for (const marker of [povmarker, poimarker]) {\n        google.maps.event.addDomListener(marker, 'dragend', () => {\n            tools.queryMatch(povmarker, poimarker)\n        })\n    }\n\n    // Reset button action\n    document.getElementById('reset').addEventListener('click', () => {\n        povmarker.setVisible(false)\n        poimarker.setVisible(false)\n        los.setVisible(false)\n        document.getElementById('step1').classList.add('active')\n        document.getElementById('step2').classList.remove('active')\n        document.getElementById('step3').classList.remove('active')\n        document.getElementById('azimuth').style.display = 'none'\n        document.getElementById('results').innerHTML = ''\n        window.location.hash = ''\n    })\n\n    // Setup map if vars passed in URL hash\n    let hash = tools.getHash()\n    if (hash.pov && hash.poi) {\n        // Parse locations from URL\n        let povpos = tools.strToLatLng(hash.pov)\n        let poipos = tools.strToLatLng(hash.poi)\n        // Move markers to locations\n        povmarker.setPosition(povpos)\n        poimarker.setPosition(poipos)\n        // Make elements visible\n        povmarker.setVisible(true)\n        poimarker.setVisible(true)\n        los.setVisible(true)\n        // Zoom map to fit both markers\n        let bounds = new google.maps.LatLngBounds()\n        bounds.extend(povpos)\n        bounds.extend(poipos)\n        map.fitBounds(bounds)\n        // Increment instruction steps\n        document.getElementById(\"step1\").classList.remove(\"active\")\n        document.getElementById(\"step3\").classList.add(\"active\")\n        document.getElementById(\"azimuth\").style.display = 'block'\n        // Finally call the backend\n        tools.queryMatch(povmarker, poimarker)\n    } else {\n        // Try HTML5 geolocation\n        // Do it only if no location in URL as asynchronous geoloc messes with fitBounds\n        tools.askGeolocation(map)\n    }\n}\n","import { Spinner } from 'spin.js'\n\n// extend Number object with methods for converting degrees / radians\ndeclare global {\n    interface Number {\n        toRad: () => number;\n        toDeg: () => number;\n        toBrng: () => number;\n        round: (decimals: number) => number;\n    }\n}\n\nexport function askGeolocation(map: google.maps.Map): void {\n    if (navigator.geolocation) {\n        navigator.geolocation.getCurrentPosition(\n            (position: GeolocationPosition) => {\n                let latlng = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);\n                map.panTo(latlng)\n            }\n        )\n    }\n}\n\nexport function getAzimuth(pov: google.maps.LatLng, poi: google.maps.LatLng): number {\n    let povLat = pov.lat().toRad()\n    let poiLat = poi.lat().toRad()\n    let dLon = (poi.lng() - pov.lng()).toRad()\n    let y = Math.sin(dLon) * Math.cos(poiLat)\n    let x = Math.cos(povLat) * Math.sin(poiLat) - Math.sin(povLat) * Math.cos(poiLat) * Math.cos(dLon)\n    return Math.atan2(y, x).toBrng()\n}\n\n// Sets the marker positions in the URL\nexport function setHash(pov: google.maps.Marker, poi: google.maps.Marker): void {\n    let povpos = pov.getPosition().toUrlValue()\n    let poipos = poi.getPosition().toUrlValue()\n    window.location.hash = `pov=${povpos}&poi=${poipos}`\n}\n\n// Decode parameters from hash\nexport function getHash(): {pov: string, poi: string} {\n    // Remove # first character of hash that URLSearchParams does not support\n    const parser = new URLSearchParams(window.location.hash.substring(1))\n    return {\n        pov: parser.get('pov'),\n        poi: parser.get('poi')\n    }\n}\n\n// Make a Google Maps LatLng object from a string\nexport function strToLatLng(str: string) {\n    let coord = str.split(\",\")\n    return new google.maps.LatLng(+coord[0], +coord[1])\n}\n    \nexport function queryMatch(pov: google.maps.Marker, poi: google.maps.Marker) {\n    // Set the spinner\n    let spinner = new Spinner({\n        lines: 13, // The number of lines to draw\n\t\tlength: 7, // The length of each line\n\t\twidth: 4, // The line thickness\n\t\tradius: 10, // The radius of the inner circle\n\t\trotate: 0, // The rotation offset\n\t\tcolor: '#333', // #rgb or #rrggbb\n\t\tspeed: 1, // Rounds per second\n\t\tshadow: false, // Whether to render a shadow\n\t\tclassName: 'spinner', // The CSS class to assign to the spinner\n\t\tzIndex: 2e9, // The z - index(defaults to 2000000000)\n\t\ttop: '50%', // Top position relative to parent in px\n        left: '50%', // Left position relative to parent in px\n    }).spin(document.getElementById('results'))\n\n    // Log a request to Google Analytics\n    _gaq.push(['_trackEvent', 'Interaction', 'Request'])\n\n    let povlat = pov.getPosition().lat().round(1)\n    const results = document.getElementById('results')\n\n    window.fetch('/findMatch', {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({ lat: povlat, az: getAzimuth(pov.getPosition(), poi.getPosition()) })\n    })\n    .then(response => response.json())\n    .then(data => {\n        if (data.matches) {\n            // Create HTML for the result days list\n            const daylist = document.createElement('ul')\n            daylist.classList.add('matches')\n            for (const day of data.matches) {\n                const dayli = document.createElement('li')\n                dayli.innerText = day\n                daylist.append(dayli)\n            }\n            // Write the type(sunrise or sunset) and results to the screen\n            results.innerText = `${data.suntype} on:`\n            results.appendChild(daylist)\n            // Log the result to Google Analytics\n            _gaq.push(['_trackEvent', 'Interaction', 'Success', data.suntype])\n        } else {\n            results.innerText = `Sorry, there is no ${data.suntype} in this direction.`\n            _gaq.push(['_trackEvent', 'Interaction', 'Success', 'Out of Bounds'])\n        }\n    })\n    .then(() => {\n        spinner.stop()\n        setHash(pov, poi)\n    })\n    .catch((error) => {\n        results.innerText = \"ERROR in the Request.\"\n        // Log the error to Google Analytics\n        _gaq.push(['_trackEvent', 'Interaction', 'Error'])\n    })\n}\n\nNumber.prototype.toRad = function (): number { // convert degrees to radians\n    return this * Math.PI / 180;\n}\n\nNumber.prototype.toDeg = function (): number { // convert radians to degrees(signed)\n    return this * 180 / Math.PI;\n}\n\nNumber.prototype.toBrng = function (): number { // convert radians to degrees(as bearing: 0...360)\n    return (this.toDeg() + 360) % 360;\n}\n\nNumber.prototype.round = function (decimals: number): number {\n    return Math.round(this * Math.pow(10, decimals)) / Math.pow(10, decimals)\n}\t\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar defaults = {\r\n    lines: 12,\r\n    length: 7,\r\n    width: 5,\r\n    radius: 10,\r\n    scale: 1.0,\r\n    corners: 1,\r\n    color: '#000',\r\n    fadeColor: 'transparent',\r\n    animation: 'spinner-line-fade-default',\r\n    rotate: 0,\r\n    direction: 1,\r\n    speed: 1,\r\n    zIndex: 2e9,\r\n    className: 'spinner',\r\n    top: '50%',\r\n    left: '50%',\r\n    shadow: '0 0 1px transparent',\r\n    position: 'absolute',\r\n};\r\nvar Spinner = /** @class */ (function () {\r\n    function Spinner(opts) {\r\n        if (opts === void 0) { opts = {}; }\r\n        this.opts = __assign(__assign({}, defaults), opts);\r\n    }\r\n    /**\r\n     * Adds the spinner to the given target element. If this instance is already\r\n     * spinning, it is automatically removed from its previous target by calling\r\n     * stop() internally.\r\n     */\r\n    Spinner.prototype.spin = function (target) {\r\n        this.stop();\r\n        this.el = document.createElement('div');\r\n        this.el.className = this.opts.className;\r\n        this.el.setAttribute('role', 'progressbar');\r\n        css(this.el, {\r\n            position: this.opts.position,\r\n            width: 0,\r\n            zIndex: this.opts.zIndex,\r\n            left: this.opts.left,\r\n            top: this.opts.top,\r\n            transform: \"scale(\" + this.opts.scale + \")\",\r\n        });\r\n        if (target) {\r\n            target.insertBefore(this.el, target.firstChild || null);\r\n        }\r\n        drawLines(this.el, this.opts);\r\n        return this;\r\n    };\r\n    /**\r\n     * Stops and removes the Spinner.\r\n     * Stopped spinners may be reused by calling spin() again.\r\n     */\r\n    Spinner.prototype.stop = function () {\r\n        if (this.el) {\r\n            if (typeof requestAnimationFrame !== 'undefined') {\r\n                cancelAnimationFrame(this.animateId);\r\n            }\r\n            else {\r\n                clearTimeout(this.animateId);\r\n            }\r\n            if (this.el.parentNode) {\r\n                this.el.parentNode.removeChild(this.el);\r\n            }\r\n            this.el = undefined;\r\n        }\r\n        return this;\r\n    };\r\n    return Spinner;\r\n}());\r\nexport { Spinner };\r\n/**\r\n * Sets multiple style properties at once.\r\n */\r\nfunction css(el, props) {\r\n    for (var prop in props) {\r\n        el.style[prop] = props[prop];\r\n    }\r\n    return el;\r\n}\r\n/**\r\n * Returns the line color from the given string or array.\r\n */\r\nfunction getColor(color, idx) {\r\n    return typeof color == 'string' ? color : color[idx % color.length];\r\n}\r\n/**\r\n * Internal method that draws the individual lines.\r\n */\r\nfunction drawLines(el, opts) {\r\n    var borderRadius = (Math.round(opts.corners * opts.width * 500) / 1000) + 'px';\r\n    var shadow = 'none';\r\n    if (opts.shadow === true) {\r\n        shadow = '0 2px 4px #000'; // default shadow\r\n    }\r\n    else if (typeof opts.shadow === 'string') {\r\n        shadow = opts.shadow;\r\n    }\r\n    var shadows = parseBoxShadow(shadow);\r\n    for (var i = 0; i < opts.lines; i++) {\r\n        var degrees = ~~(360 / opts.lines * i + opts.rotate);\r\n        var backgroundLine = css(document.createElement('div'), {\r\n            position: 'absolute',\r\n            top: -opts.width / 2 + \"px\",\r\n            width: (opts.length + opts.width) + 'px',\r\n            height: opts.width + 'px',\r\n            background: getColor(opts.fadeColor, i),\r\n            borderRadius: borderRadius,\r\n            transformOrigin: 'left',\r\n            transform: \"rotate(\" + degrees + \"deg) translateX(\" + opts.radius + \"px)\",\r\n        });\r\n        var delay = i * opts.direction / opts.lines / opts.speed;\r\n        delay -= 1 / opts.speed; // so initial animation state will include trail\r\n        var line = css(document.createElement('div'), {\r\n            width: '100%',\r\n            height: '100%',\r\n            background: getColor(opts.color, i),\r\n            borderRadius: borderRadius,\r\n            boxShadow: normalizeShadow(shadows, degrees),\r\n            animation: 1 / opts.speed + \"s linear \" + delay + \"s infinite \" + opts.animation,\r\n        });\r\n        backgroundLine.appendChild(line);\r\n        el.appendChild(backgroundLine);\r\n    }\r\n}\r\nfunction parseBoxShadow(boxShadow) {\r\n    var regex = /^\\s*([a-zA-Z]+\\s+)?(-?\\d+(\\.\\d+)?)([a-zA-Z]*)\\s+(-?\\d+(\\.\\d+)?)([a-zA-Z]*)(.*)$/;\r\n    var shadows = [];\r\n    for (var _i = 0, _a = boxShadow.split(','); _i < _a.length; _i++) {\r\n        var shadow = _a[_i];\r\n        var matches = shadow.match(regex);\r\n        if (matches === null) {\r\n            continue; // invalid syntax\r\n        }\r\n        var x = +matches[2];\r\n        var y = +matches[5];\r\n        var xUnits = matches[4];\r\n        var yUnits = matches[7];\r\n        if (x === 0 && !xUnits) {\r\n            xUnits = yUnits;\r\n        }\r\n        if (y === 0 && !yUnits) {\r\n            yUnits = xUnits;\r\n        }\r\n        if (xUnits !== yUnits) {\r\n            continue; // units must match to use as coordinates\r\n        }\r\n        shadows.push({\r\n            prefix: matches[1] || '',\r\n            x: x,\r\n            y: y,\r\n            xUnits: xUnits,\r\n            yUnits: yUnits,\r\n            end: matches[8],\r\n        });\r\n    }\r\n    return shadows;\r\n}\r\n/**\r\n * Modify box-shadow x/y offsets to counteract rotation\r\n */\r\nfunction normalizeShadow(shadows, degrees) {\r\n    var normalized = [];\r\n    for (var _i = 0, shadows_1 = shadows; _i < shadows_1.length; _i++) {\r\n        var shadow = shadows_1[_i];\r\n        var xy = convertOffset(shadow.x, shadow.y, degrees);\r\n        normalized.push(shadow.prefix + xy[0] + shadow.xUnits + ' ' + xy[1] + shadow.yUnits + shadow.end);\r\n    }\r\n    return normalized.join(', ');\r\n}\r\nfunction convertOffset(x, y, degrees) {\r\n    var radians = degrees * Math.PI / 180;\r\n    var sin = Math.sin(radians);\r\n    var cos = Math.cos(radians);\r\n    return [\r\n        Math.round((x * cos + y * sin) * 1000) / 1000,\r\n        Math.round((-x * sin + y * cos) * 1000) / 1000,\r\n    ];\r\n}\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};"],"sourceRoot":""}