{"version":3,"file":"bundle.js","mappings":"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","sources":["webpack://sunsetter/./static/src/app.ts","webpack://sunsetter/./static/src/tools.ts","webpack://sunsetter/./node_modules/spin.js/spin.js","webpack://sunsetter/webpack/bootstrap","webpack://sunsetter/webpack/runtime/define property getters","webpack://sunsetter/webpack/runtime/hasOwnProperty shorthand","webpack://sunsetter/webpack/runtime/make namespace object"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar tools = require(\"./tools\");\nvar tokyo = new google.maps.LatLng(35.41, 139.44);\nwindow.onload = function () {\n    // Create map\n    var map = new google.maps.Map(document.getElementById(\"map_canvas\"), {\n        center: tokyo,\n        zoom: 9,\n        mapTypeId: google.maps.MapTypeId.ROADMAP\n    });\n    // Default marker position\n    var markerpos = new google.maps.LatLng(1, 1);\n    // Initialize POV and POI Markers as well as LOS Polyline\n    var povmarker = new google.maps.Marker({\n        position: markerpos,\n        map: map,\n        icon: povicon,\n        draggable: true,\n        visible: false\n    });\n    var poimarker = new google.maps.Marker({\n        position: markerpos,\n        map: map,\n        draggable: true,\n        visible: false\n    });\n    var los = new google.maps.Polyline({\n        path: [\n            povmarker.getPosition(),\n            poimarker.getPosition()\n        ],\n        strokeColor: \"#FF0000\",\n        strokeOpacity: 0.6,\n        strokeWeight: 6,\n        visible: false\n    });\n    los.setMap(map);\n    var resultsDOM = document.getElementById('results');\n    var azimuthDOM = document.getElementById('azimuth');\n    // Click on the map event - works only 2 first times\n    google.maps.event.addListener(map, 'click', function (event) {\n        // First click, show POV marker\n        if (!povmarker.getVisible()) {\n            povmarker.setPosition(event.latLng);\n            povmarker.setVisible(true);\n            document.getElementById(\"step1\").classList.remove(\"active\");\n            document.getElementById(\"step2\").classList.add(\"active\");\n            // Second click, show POI marker\n        }\n        else if (!poimarker.getVisible()) {\n            poimarker.setPosition(event.latLng);\n            poimarker.setVisible(true);\n            los.setVisible(true);\n            document.getElementById(\"azimuth\").style.display = 'block';\n            tools.queryMatch(povmarker, poimarker);\n            document.getElementById(\"step2\").classList.remove(\"active\");\n            document.getElementById(\"step3\").classList.add(\"active\");\n        }\n    });\n    // Move markers event\n    for (var _i = 0, _a = [povmarker, poimarker]; _i < _a.length; _i++) {\n        var marker = _a[_i];\n        google.maps.event.addDomListener(marker, 'position_changed', function () {\n            los.setPath([povmarker.getPosition(), poimarker.getPosition()]);\n            var az = tools.getAzimuth(povmarker.getPosition(), poimarker.getPosition());\n            azimuthDOM.innerText = \"\".concat(az.round(2), \"\\u00BA\");\n            // Clear results\n            resultsDOM.innerHTML = '';\n        });\n    }\n    // Query for a match on drop\n    for (var _b = 0, _c = [povmarker, poimarker]; _b < _c.length; _b++) {\n        var marker = _c[_b];\n        google.maps.event.addDomListener(marker, 'dragend', function () {\n            tools.queryMatch(povmarker, poimarker);\n        });\n    }\n    // Reset button action\n    document.getElementById('reset').addEventListener('click', function () {\n        povmarker.setVisible(false);\n        poimarker.setVisible(false);\n        los.setVisible(false);\n        document.getElementById('step1').classList.add('active');\n        document.getElementById('step2').classList.remove('active');\n        document.getElementById('step3').classList.remove('active');\n        document.getElementById('azimuth').style.display = 'none';\n        document.getElementById('results').innerHTML = '';\n        window.location.hash = '';\n    });\n    // Setup map if vars passed in URL hash\n    var hash = tools.getHash();\n    if (hash.pov && hash.poi) {\n        // Parse locations from URL\n        var povpos = tools.strToLatLng(hash.pov);\n        var poipos = tools.strToLatLng(hash.poi);\n        // Move markers to locations\n        povmarker.setPosition(povpos);\n        poimarker.setPosition(poipos);\n        // Make elements visible\n        povmarker.setVisible(true);\n        poimarker.setVisible(true);\n        los.setVisible(true);\n        // Zoom map to fit both markers\n        var bounds = new google.maps.LatLngBounds();\n        bounds.extend(povpos);\n        bounds.extend(poipos);\n        map.fitBounds(bounds);\n        // Increment instruction steps\n        document.getElementById(\"step1\").classList.remove(\"active\");\n        document.getElementById(\"step3\").classList.add(\"active\");\n        document.getElementById(\"azimuth\").style.display = 'block';\n        // Finally call the backend\n        tools.queryMatch(povmarker, poimarker);\n    }\n    else {\n        // Try HTML5 geolocation\n        // Do it only if no location in URL as asynchronous geoloc messes with fitBounds\n        tools.askGeolocation(map);\n    }\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.queryMatch = exports.strToLatLng = exports.getHash = exports.setHash = exports.getAzimuth = exports.askGeolocation = void 0;\nvar spin_js_1 = require(\"spin.js\");\nfunction askGeolocation(map) {\n    if (navigator.geolocation) {\n        navigator.geolocation.getCurrentPosition(function (position) {\n            var latlng = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);\n            map.panTo(latlng);\n        });\n    }\n}\nexports.askGeolocation = askGeolocation;\nfunction getAzimuth(pov, poi) {\n    var povLat = pov.lat().toRad();\n    var poiLat = poi.lat().toRad();\n    var dLon = (poi.lng() - pov.lng()).toRad();\n    var y = Math.sin(dLon) * Math.cos(poiLat);\n    var x = Math.cos(povLat) * Math.sin(poiLat) - Math.sin(povLat) * Math.cos(poiLat) * Math.cos(dLon);\n    return Math.atan2(y, x).toBrng();\n}\nexports.getAzimuth = getAzimuth;\n// Sets the marker positions in the URL\nfunction setHash(pov, poi) {\n    var povpos = pov.getPosition().toUrlValue();\n    var poipos = poi.getPosition().toUrlValue();\n    window.location.hash = \"pov=\".concat(povpos, \"&poi=\").concat(poipos);\n}\nexports.setHash = setHash;\n// Decode parameters from hash\nfunction getHash() {\n    // Remove # first character of hash that URLSearchParams does not support\n    var parser = new URLSearchParams(window.location.hash.substring(1));\n    return {\n        pov: parser.get('pov'),\n        poi: parser.get('poi')\n    };\n}\nexports.getHash = getHash;\n// Make a Google Maps LatLng object from a string\nfunction strToLatLng(str) {\n    var coord = str.split(\",\");\n    return new google.maps.LatLng(+coord[0], +coord[1]);\n}\nexports.strToLatLng = strToLatLng;\nfunction queryMatch(pov, poi) {\n    // Set the spinner\n    var spinner = new spin_js_1.Spinner({\n        lines: 13,\n        length: 7,\n        width: 4,\n        radius: 10,\n        rotate: 0,\n        color: '#333',\n        speed: 1,\n        shadow: false,\n        className: 'spinner',\n        zIndex: 2e9,\n        top: '50%',\n        left: '50%', // Left position relative to parent in px\n    }).spin(document.getElementById('results'));\n    // Log a request to Google Analytics\n    _gaq.push(['_trackEvent', 'Interaction', 'Request']);\n    var povlat = pov.getPosition().lat().round(1);\n    var results = document.getElementById('results');\n    window.fetch('/findMatch', {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({ lat: povlat, az: getAzimuth(pov.getPosition(), poi.getPosition()) })\n    })\n        .then(function (response) { return response.json(); })\n        .then(function (data) {\n        if (data.matches) {\n            // Create HTML for the result days list\n            var daylist = document.createElement('ul');\n            daylist.classList.add('matches');\n            for (var _i = 0, _a = data.matches; _i < _a.length; _i++) {\n                var day = _a[_i];\n                var dayli = document.createElement('li');\n                dayli.innerText = day;\n                daylist.append(dayli);\n            }\n            // Write the type(sunrise or sunset) and results to the screen\n            results.innerText = \"\".concat(data.suntype, \" on:\");\n            results.appendChild(daylist);\n            // Log the result to Google Analytics\n            _gaq.push(['_trackEvent', 'Interaction', 'Success', data.suntype]);\n        }\n        else {\n            results.innerText = \"Sorry, there is no \".concat(data.suntype, \" in this direction.\");\n            _gaq.push(['_trackEvent', 'Interaction', 'Success', 'Out of Bounds']);\n        }\n    })\n        .then(function () {\n        spinner.stop();\n        setHash(pov, poi);\n    })\n        .catch(function (error) {\n        results.innerText = \"ERROR in the Request.\";\n        // Log the error to Google Analytics\n        _gaq.push(['_trackEvent', 'Interaction', 'Error']);\n    });\n}\nexports.queryMatch = queryMatch;\nNumber.prototype.toRad = function () {\n    return this * Math.PI / 180;\n};\nNumber.prototype.toDeg = function () {\n    return this * 180 / Math.PI;\n};\nNumber.prototype.toBrng = function () {\n    return (this.toDeg() + 360) % 360;\n};\nNumber.prototype.round = function (decimals) {\n    return Math.round(this * Math.pow(10, decimals)) / Math.pow(10, decimals);\n};\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar defaults = {\r\n    lines: 12,\r\n    length: 7,\r\n    width: 5,\r\n    radius: 10,\r\n    scale: 1.0,\r\n    corners: 1,\r\n    color: '#000',\r\n    fadeColor: 'transparent',\r\n    animation: 'spinner-line-fade-default',\r\n    rotate: 0,\r\n    direction: 1,\r\n    speed: 1,\r\n    zIndex: 2e9,\r\n    className: 'spinner',\r\n    top: '50%',\r\n    left: '50%',\r\n    shadow: '0 0 1px transparent',\r\n    position: 'absolute',\r\n};\r\nvar Spinner = /** @class */ (function () {\r\n    function Spinner(opts) {\r\n        if (opts === void 0) { opts = {}; }\r\n        this.opts = __assign(__assign({}, defaults), opts);\r\n    }\r\n    /**\r\n     * Adds the spinner to the given target element. If this instance is already\r\n     * spinning, it is automatically removed from its previous target by calling\r\n     * stop() internally.\r\n     */\r\n    Spinner.prototype.spin = function (target) {\r\n        this.stop();\r\n        this.el = document.createElement('div');\r\n        this.el.className = this.opts.className;\r\n        this.el.setAttribute('role', 'progressbar');\r\n        css(this.el, {\r\n            position: this.opts.position,\r\n            width: 0,\r\n            zIndex: this.opts.zIndex,\r\n            left: this.opts.left,\r\n            top: this.opts.top,\r\n            transform: \"scale(\" + this.opts.scale + \")\",\r\n        });\r\n        if (target) {\r\n            target.insertBefore(this.el, target.firstChild || null);\r\n        }\r\n        drawLines(this.el, this.opts);\r\n        return this;\r\n    };\r\n    /**\r\n     * Stops and removes the Spinner.\r\n     * Stopped spinners may be reused by calling spin() again.\r\n     */\r\n    Spinner.prototype.stop = function () {\r\n        if (this.el) {\r\n            if (typeof requestAnimationFrame !== 'undefined') {\r\n                cancelAnimationFrame(this.animateId);\r\n            }\r\n            else {\r\n                clearTimeout(this.animateId);\r\n            }\r\n            if (this.el.parentNode) {\r\n                this.el.parentNode.removeChild(this.el);\r\n            }\r\n            this.el = undefined;\r\n        }\r\n        return this;\r\n    };\r\n    return Spinner;\r\n}());\r\nexport { Spinner };\r\n/**\r\n * Sets multiple style properties at once.\r\n */\r\nfunction css(el, props) {\r\n    for (var prop in props) {\r\n        el.style[prop] = props[prop];\r\n    }\r\n    return el;\r\n}\r\n/**\r\n * Returns the line color from the given string or array.\r\n */\r\nfunction getColor(color, idx) {\r\n    return typeof color == 'string' ? color : color[idx % color.length];\r\n}\r\n/**\r\n * Internal method that draws the individual lines.\r\n */\r\nfunction drawLines(el, opts) {\r\n    var borderRadius = (Math.round(opts.corners * opts.width * 500) / 1000) + 'px';\r\n    var shadow = 'none';\r\n    if (opts.shadow === true) {\r\n        shadow = '0 2px 4px #000'; // default shadow\r\n    }\r\n    else if (typeof opts.shadow === 'string') {\r\n        shadow = opts.shadow;\r\n    }\r\n    var shadows = parseBoxShadow(shadow);\r\n    for (var i = 0; i < opts.lines; i++) {\r\n        var degrees = ~~(360 / opts.lines * i + opts.rotate);\r\n        var backgroundLine = css(document.createElement('div'), {\r\n            position: 'absolute',\r\n            top: -opts.width / 2 + \"px\",\r\n            width: (opts.length + opts.width) + 'px',\r\n            height: opts.width + 'px',\r\n            background: getColor(opts.fadeColor, i),\r\n            borderRadius: borderRadius,\r\n            transformOrigin: 'left',\r\n            transform: \"rotate(\" + degrees + \"deg) translateX(\" + opts.radius + \"px)\",\r\n        });\r\n        var delay = i * opts.direction / opts.lines / opts.speed;\r\n        delay -= 1 / opts.speed; // so initial animation state will include trail\r\n        var line = css(document.createElement('div'), {\r\n            width: '100%',\r\n            height: '100%',\r\n            background: getColor(opts.color, i),\r\n            borderRadius: borderRadius,\r\n            boxShadow: normalizeShadow(shadows, degrees),\r\n            animation: 1 / opts.speed + \"s linear \" + delay + \"s infinite \" + opts.animation,\r\n        });\r\n        backgroundLine.appendChild(line);\r\n        el.appendChild(backgroundLine);\r\n    }\r\n}\r\nfunction parseBoxShadow(boxShadow) {\r\n    var regex = /^\\s*([a-zA-Z]+\\s+)?(-?\\d+(\\.\\d+)?)([a-zA-Z]*)\\s+(-?\\d+(\\.\\d+)?)([a-zA-Z]*)(.*)$/;\r\n    var shadows = [];\r\n    for (var _i = 0, _a = boxShadow.split(','); _i < _a.length; _i++) {\r\n        var shadow = _a[_i];\r\n        var matches = shadow.match(regex);\r\n        if (matches === null) {\r\n            continue; // invalid syntax\r\n        }\r\n        var x = +matches[2];\r\n        var y = +matches[5];\r\n        var xUnits = matches[4];\r\n        var yUnits = matches[7];\r\n        if (x === 0 && !xUnits) {\r\n            xUnits = yUnits;\r\n        }\r\n        if (y === 0 && !yUnits) {\r\n            yUnits = xUnits;\r\n        }\r\n        if (xUnits !== yUnits) {\r\n            continue; // units must match to use as coordinates\r\n        }\r\n        shadows.push({\r\n            prefix: matches[1] || '',\r\n            x: x,\r\n            y: y,\r\n            xUnits: xUnits,\r\n            yUnits: yUnits,\r\n            end: matches[8],\r\n        });\r\n    }\r\n    return shadows;\r\n}\r\n/**\r\n * Modify box-shadow x/y offsets to counteract rotation\r\n */\r\nfunction normalizeShadow(shadows, degrees) {\r\n    var normalized = [];\r\n    for (var _i = 0, shadows_1 = shadows; _i < shadows_1.length; _i++) {\r\n        var shadow = shadows_1[_i];\r\n        var xy = convertOffset(shadow.x, shadow.y, degrees);\r\n        normalized.push(shadow.prefix + xy[0] + shadow.xUnits + ' ' + xy[1] + shadow.yUnits + shadow.end);\r\n    }\r\n    return normalized.join(', ');\r\n}\r\nfunction convertOffset(x, y, degrees) {\r\n    var radians = degrees * Math.PI / 180;\r\n    var sin = Math.sin(radians);\r\n    var cos = Math.cos(radians);\r\n    return [\r\n        Math.round((x * cos + y * sin) * 1000) / 1000,\r\n        Math.round((-x * sin + y * cos) * 1000) / 1000,\r\n    ];\r\n}\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};"],"names":["tools","tokyo","Object","defineProperty","exports","value","queryMatch","strToLatLng","getHash","setHash","getAzimuth","askGeolocation","spin_js_1","pov","poi","povLat","lat","toRad","poiLat","dLon","lng","y","Math","sin","cos","x","atan2","toBrng","povpos","getPosition","toUrlValue","poipos","window","location","hash","concat","map","navigator","geolocation","getCurrentPosition","position","latlng","google","maps","LatLng","coords","latitude","longitude","panTo","parser","URLSearchParams","substring","get","str","coord","split","spinner","Spinner","lines","length","width","radius","rotate","color","speed","shadow","className","zIndex","top","left","spin","document","getElementById","_gaq","push","povlat","round","results","fetch","method","headers","body","JSON","stringify","az","then","response","json","data","matches","daylist","createElement","classList","add","_i","_a","day","dayli","innerText","append","suntype","appendChild","stop","catch","error","Number","prototype","this","PI","toDeg","decimals","pow","__assign","assign","t","s","i","n","arguments","p","hasOwnProperty","call","apply","defaults","scale","corners","fadeColor","animation","direction","opts","target","el","setAttribute","css","transform","insertBefore","firstChild","borderRadius","shadows","boxShadow","regex","match","xUnits","yUnits","prefix","end","parseBoxShadow","degrees","backgroundLine","height","background","getColor","transformOrigin","delay","line","normalizeShadow","drawLines","requestAnimationFrame","cancelAnimationFrame","animateId","clearTimeout","parentNode","removeChild","undefined","props","prop","style","idx","normalized","shadows_1","xy","convertOffset","join","radians","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","module","__webpack_modules__","d","definition","key","o","enumerable","obj","r","Symbol","toStringTag","onload","Map","center","zoom","mapTypeId","MapTypeId","ROADMAP","markerpos","povmarker","Marker","icon","povicon","draggable","visible","poimarker","los","Polyline","path","strokeColor","strokeOpacity","strokeWeight","setMap","resultsDOM","azimuthDOM","event","addListener","getVisible","setPosition","latLng","setVisible","display","remove","marker","addDomListener","setPath","innerHTML","_b","_c","addEventListener","bounds","LatLngBounds","extend","fitBounds"],"sourceRoot":""}